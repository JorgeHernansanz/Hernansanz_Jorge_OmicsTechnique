Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 2)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
EntrezUni <- c(topAnnotated_diff1$ENTREZID, topAnnotated_diff2$ENTREZID)
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-1]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2], header=TRUE
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2] header=TRUE
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1)
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
Mod1[,1:3]
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
Mod1[1:6,1:3]
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
Mod1[1:5,1:3]
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
Mod1[1:4,1:3]
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
Mod1[,1:3]
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
Mod2[1:6,1:3]
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
heada(Mod2[],1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[],1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",", row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[1:3,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",", row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Treat1
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Treat1
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
TReat2
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat1 <- arrange(Tab.react, - pvalue)
Treat1
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Treat2
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
knitr::opts_chunk$set(echo = TRUE)
require(oligo)
require(Biobase)
require(arrayQualityMetrics)
require(genefilter)
require(Biobase)
require(hgu219.db)
require(limma)
require(gplots)
require(ReactomePA)
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Tab.react
Treat1 <- arrange(Tab.react, - pvalue)
require(tidyverse)
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Tab.react
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Tab.react
Treat1 <- arrange(Tab.react, - pvalue)
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Tab.react
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 2)
Tab.react
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 1)
Tab.react
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 2)
Tab.react
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 2)
Tab.react[,1:3]
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
Tab.react <- read.csv(file.path("./Results/ReactomePA.Results.diff1.csv"),
sep = ",",header = TRUE, row.names = 2)
Tab.react[,3:4]
Mod1<-Treat1[,-2]
head(Mod1[,1:3])
Tab.react2 <- read.csv(file.path("./Results/ReactomePA.Results.diff2.csv"),
sep = ",",header = TRUE, row.names = 1)
Treat2 <- arrange(Tab.react2, - pvalue)
Mod2<-Treat2[,-2]
head(Mod2[,1:3])
EntrezUni <- c(topAnnotated_diff1$ENTREZID, topAnnotated_diff2$ENTREZID)
annotatedTopTable <- function(topTab, anotPackage)
{
topTab<-cbind(PROBEID=rownames(topTab), topTab)
myprobes <- rownames(topTab)
thePackage <- eval(parse(text=anotPackage))
geneAnots <- select(thePackage, myprobes, c('SYMBOL','ENTREZID','GENENAME'))
annotatedTopTab <- merge (x=geneAnots, y = topTab, by.x='PROBEID', by.y='PROBEID')
return (annotatedTopTab)
}
#topAnnotated_diff1 <- annotatedTopTable(first_comparison[0], anotPackage = "hgu219.db")
head(topAnnotated_diff1_[1:4])
annotatedTopTable <- function(topTab, anotPackage)
{
topTab<-cbind(PROBEID=rownames(topTab), topTab)
myprobes <- rownames(topTab)
thePackage <- eval(parse(text=anotPackage))
geneAnots <- select(thePackage, myprobes, c('SYMBOL','ENTREZID','GENENAME'))
annotatedTopTab <- merge (x=geneAnots, y = topTab, by.x='PROBEID', by.y='PROBEID')
return (annotatedTopTab)
}
topAnnotated_diff1 <- annotatedTopTable(first_comparison, anotPackage = "hgu219.db"); head(topAnnotated_diff1)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
require(oligo)
require(Biobase)
require(arrayQualityMetrics)
require(genefilter)
require(Biobase)
require(hgu219.db)
require(limma)
require(gplots)
require(ReactomePA)
knitr::opts_chunk$set(echo = TRUE)
require(oligo)
require(Biobase)
require(arrayQualityMetrics)
require(genefilter)
require(Biobase)
require(hgu219.db)
require(limma)
require(gplots)
require(ReactomePA)
knitr::opts_chunk$set(echo = TRUE)
require(oligo)
require(Biobase)
require(arrayQualityMetrics)
require(genefilter)
require(Biobase)
require(hgu219.db)
require(limma)
require(gplots)
require(ReactomePA)
knitr::opts_chunk$set(echo = TRUE)
targets <-read.table("./Data/Targets.txt", header = TRUE, sep="\t")
#targets
summary(targets[2:5])
CELfiles <- list.celfiles(file.path("./Data/Cell_files"),full.names=TRUE)
data_CEL=read.celfiles(CELfiles)
my_targets<- read.AnnotatedDataFrame(file.path("./Data/Targets.txt"),header=TRUE, row.names = 1, sep = "\t")
rawData <- read.celfiles(CELfiles, phenoData = my_targets)
knitr::opts_chunk$set(echo = TRUE)
sampleNames <- as.character(targets$SHORT_NAME)
sampleColor <- as.character(targets$COLORS)
IDs <- as.character(targets$ID)
#sampleNames
#sampleColor
#IDs
knitr::opts_chunk$set(echo = TRUE)
eset <- rma(rawData)
knitr::opts_chunk$set(echo = TRUE)
annotation(eset) <- 'hgu219.db'
filter <- nsFilter(eset, var.func=IQR,
var.cutoff=0.75, var.filter=TRUE,
filterByQuantile=TRUE)
eset_filtered <- filter$eset
eset_filtered
names_fac <- factor(sampleNames, levels = unique(sampleNames))
#names_fac
design_matrix <- model.matrix(~0+names_fac, pData(eset_filtered))
colnames(design_matrix)<- colnames(design_matrix)<- c('E_UC','dE_UC','E_NC','dE_NC')
rownames(design_matrix)<- rownames(design_matrix)<- IDs
design_matrix
knitr::opts_chunk$set(echo = TRUE)
cont.matrix <- makeContrasts (
diff1 = E_UC - E_NC,
diff2 = dE_UC - dE_NC,
diff3 = (E_UC - E_NC) - (dE_UC - dE_NC),
levels=design_matrix)
cont.matrix
fit<-lmFit (eset_filtered,design_matrix)
fit.main<-contrasts.fit(fit, cont.matrix)
fit.main<-eBayes(fit.main)
knitr::opts_chunk$set(echo = TRUE)
first_comparison <- topTable (fit.main, number=nrow(fit.main), coef="diff1", adjust="fdr"); head(first_comparison[1:5])
second_comparison <- topTable (fit.main, number=nrow(fit.main), coef="diff2", adjust="fdr"); head(second_comparison[1:5])
third_comparison <- topTable(fit.main, number=nrow(fit.main), coef="diff3", adjust="fdr"); head(third_comparison[1:5])
knitr::opts_chunk$set(echo = TRUE)
annotatedTopTable <- function(topTab, anotPackage)
{
topTab<-cbind(PROBEID=rownames(topTab), topTab)
myprobes <- rownames(topTab)
thePackage <- eval(parse(text=anotPackage))
geneAnots <- select(thePackage, myprobes, c('SYMBOL','ENTREZID','GENENAME'))
annotatedTopTab <- merge (x=geneAnots, y = topTab, by.x='PROBEID', by.y='PROBEID')
return (annotatedTopTab)
}
topAnnotated_diff1_ <- annotatedTopTable(first_comparison[1:10,1:5], anotPackage = "hgu219.db"); head(topAnnotated_diff1_)
topAnnotated_diff2_ <- annotatedTopTable(second_comparison[1:10,1:5], anotPackage = "hgu219.db"); head(topAnnotated_diff2_)
topAnnotated_diff3_ <- annotatedTopTable(third_comparison[1:10,1:5],anotPackage = "hgu219.db"); head(topAnnotated_diff3_)
annotatedTopTable <- function(topTab, anotPackage)
{
topTab<-cbind(PROBEID=rownames(topTab), topTab)
myprobes <- rownames(topTab)
thePackage <- eval(parse(text=anotPackage))
geneAnots <- select(thePackage, myprobes, c('SYMBOL','ENTREZID','GENENAME'))
annotatedTopTab <- merge (x=geneAnots, y = topTab, by.x='PROBEID', by.y='PROBEID')
return (annotatedTopTab)
}
topAnnotated_diff1_ <- annotatedTopTable(first_comparison[1:10,1:5], anotPackage = "hgu219.db"); head(topAnnotated_diff1_)
topAnnotated_diff2_ <- annotatedTopTable(second_comparison[1:10,1:5], anotPackage = "hgu219.db"); head(topAnnotated_diff2_)
topAnnotated_diff3_ <- annotatedTopTable(third_comparison[1:10,1:5],anotPackage = "hgu219.db"); head(topAnnotated_diff3_)
View(topAnnotated_diff1_)
View(topAnnotated_diff2_)
View(topAnnotated_diff3_)
knitr::opts_chunk$set(echo = TRUE)
targets <-read.table("./Data/Targets.txt", header = TRUE, sep="\t")
#targets
summary(targets[2:5])
CELfiles <- list.celfiles(file.path("./Data/Cell_files"),full.names=TRUE)
data_CEL=read.celfiles(CELfiles)
my_targets<- read.AnnotatedDataFrame(file.path("./Data/Targets.txt"),header=TRUE, row.names = 1, sep = "\t")
rawData <- read.celfiles(CELfiles, phenoData = my_targets)
sampleNames <- as.character(targets$SHORT_NAME)
sampleColor <- as.character(targets$COLORS)
IDs <- as.character(targets$ID)
#sampleNames
#sampleColor
#IDs
eset <- rma(rawData)
annotation(eset) <- 'hgu219.db'
filter <- nsFilter(eset, var.func=IQR,
var.cutoff=0.75, var.filter=TRUE,
filterByQuantile=TRUE)
eset_filtered <- filter$eset
eset_filtered
names_fac <- factor(sampleNames, levels = unique(sampleNames))
#names_fac
design_matrix <- model.matrix(~0+names_fac, pData(eset_filtered))
colnames(design_matrix)<- colnames(design_matrix)<- c('E_UC','dE_UC','E_NC','dE_NC')
rownames(design_matrix)<- rownames(design_matrix)<- IDs
design_matrix
cont.matrix <- makeContrasts (
diff1 = E_UC - E_NC,
diff2 = dE_UC - dE_NC,
diff3 = (E_UC - E_NC) - (dE_UC - dE_NC),
levels=design_matrix)
cont.matrix
fit<-lmFit (eset_filtered,design_matrix)
fit.main<-contrasts.fit(fit, cont.matrix)
fit.main<-eBayes(fit.main)
first_comparison <- topTable (fit.main, number=nrow(fit.main), coef="diff1", adjust="fdr"); head(first_comparison[1:5])
second_comparison <- topTable (fit.main, number=nrow(fit.main), coef="diff2", adjust="fdr"); head(second_comparison[1:5])
third_comparison <- topTable(fit.main, number=nrow(fit.main), coef="diff3", adjust="fdr"); head(third_comparison[1:5])
annotatedTopTable <- function(topTab, anotPackage)
{
topTab<-cbind(PROBEID=rownames(topTab), topTab)
myprobes <- rownames(topTab)
thePackage <- eval(parse(text=anotPackage))
geneAnots <- select(thePackage, myprobes, c('SYMBOL','ENTREZID','GENENAME'))
annotatedTopTab <- merge (x=geneAnots, y = topTab, by.x='PROBEID', by.y='PROBEID')
return (annotatedTopTab)
}
topAnnotated_diff1_ <- annotatedTopTable(first_comparison[1:10,1:5], anotPackage = "hgu219.db"); head(topAnnotated_diff1_)
topAnnotated_diff2_ <- annotatedTopTable(second_comparison[1:10,1:5], anotPackage = "hgu219.db"); head(topAnnotated_diff2_)
topAnnotated_diff3_ <- annotatedTopTable(third_comparison[1:10,1:5],anotPackage = "hgu219.db"); head(topAnnotated_diff3_)
